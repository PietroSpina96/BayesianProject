?
library(readxl)
dmr_data <- read_excel("C:/Users/pietr/Desktop/Pietro/Lavoro dmr/PPScore Data V2 - Copia.xlsx")
View(dmr_data)
dmr_data1 <- dmr_data;
attach(dmr_data1)
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (njs);
emed_js = c(ENG_RATE);
eadvmed_js = c(ADV_ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:Bs){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
pairs(~FOLLOWERS+REAL_PEOPLE_PERC+POSTS+ENG_RATE+ADV_ENG_RATE+FASHION_AUDIENCE_PERC)
vmed_js = seq(0,0,length.out = Bs);
for (i in 1:Bs){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS MEDIE";
dmr_data1 = dmr_data;
attach(dmr_data1);
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (njs);
emed_js = c(ENG_RATE);
eadvmed_js = c(ADV_ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:Bs){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
pairs(~FOLLOWERS+REAL_PEOPLE_PERC+POSTS+ENG_RATE+ADV_ENG_RATE+FASHION_AUDIENCE_PERC)
vmed_js = seq(0,0,length.out = Bs);
for (i in 1:Bs){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS MEDIE";
dmr_data1 = dmr_data;
attach(dmr_data1);
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (n_js);
emed_js = c(ENG_RATE);
eadvmed_js = c(ADV_ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:B_s){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
pairs(~FOLLOWERS+REAL_PEOPLE_PERC+POSTS+ENG_RATE+ADV_ENG_RATE+FASHION_AUDIENCE_PERC)
vmed_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS MEDIE";
View(dmr_data1)
colnames(dmr_data1)[9] <- "VIEWS_MEDIE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100));
}
v_
vrate_js
)
dmr_data
end
close
}
dmr_data1[140]
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)))*100;
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[9] <- "VIEWS_RATE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)))*100;
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[10] <- "VIEWS_RATE";
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS_MEDIE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)))*100;
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[10] <- "VIEWS_RATE";
pairs(~REAL_PEOPLE_PERC+ENG_RATE+VIEWS_RATE+FASHION_AUDIENCE_PERC)
dmr_data1 = dmr_data;
attach(dmr_data1);
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (n_js);
emed_js = c(ENG_RATE);
eadvmed_js = c(ADV_ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:B_s){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
pairs(~FOLLOWERS+REAL_PEOPLE_PERC+POSTS+ENG_RATE+ADV_ENG_RATE+FASHION_AUDIENCE_PERC)
vmed_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS_MEDIE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)))*100;
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[10] <- "VIEWS_RATE";
pairs(~REAL_PEOPLE_PERC+ENG_RATE+VIEWS_RATE+FASHION_AUDIENCE_PERC)
attach(dmr_data1)
pairs(~REAL_PEOPLE_PERC+ENG_RATE+VIEWS_RATE+FASHION_AUDIENCE_PERC)
attach(dmr_data1)
pairs(~REAL_PEOPLE_PERC+ENG_RATE+ADV_ENG_RATE+VIEWS_RATE+FASHION_AUDIENCE_PERC)
203295*56.11/100
effadv_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
effadv_js[i] = (VIEWS_RATE[i]*FASHION_AUDIENCE_PERC[i])*100;
}
dmr_data1[[11]] = effadv_js
colnames(dmr_data1)[11] <- "EFF_ADV_RATE"
effadv_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
effadv_js[i] = ((VIEWS_RATE[i]/100)*FASHION_AUDIENCE_PERC[i])*100;
}
dmr_data1[[11]] = effadv_js
colnames(dmr_data1)[11] <- "EFF_ADV_RATE"
dmr_data1 = dmr_data;
attach(dmr_data1);
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (n_js);
emed_js = c(ENG_RATE);
eadvmed_js = c(ADV_ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:B_s){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
vmed_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS_MEDIE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)));
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[10] <- "VIEWS_RATE";
vmedfash_js = seq(0,0,length.out = B_s);
efffash_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmedfash_js[i] = VIEWS_MEDIE[i] * FASHION_AUDIENCE_PERC[i];
}
for (i in 1:B_s){
efffash_js[i] = (vmedfash_js[i]/(FOLLOWERS[i]*REAL_PEOPLE_PERC[i]))*100;
}
dmr_data1[[11]] = vmedfash_js;
dmr_data1[[12]] = efffash_js;
colnames(dmr_data1)[11] = "FASHION_VIEWS_MEDIE";
colnames(dmr_data1)[12] = "FASHION_EFF_RATE";
attach(dmr_data1);
dmr_data2 = dmr_data1;
dmr_data2$ADV_ENG_RATE[which(is.na(dmr_data2$ADV_ENG_RATE) == T)] = 0;
emedadv_js = c(dmr_data2$ADV_ENG_RATE);
emaxadv_js = max (emedadv_js);
vadv_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vadv_js[i] = FOLLOWERS[i]*(emedadv_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emedadv_js[i]/emaxadv_js)*(1 - emedadv_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)
}
vadvfash_js = seq(0,0,length(B_s));
for (i in 1:B_s){
vadvfash_js[i] = vadv_js[i] * FASHION_AUDIENCE_PERC[i];
}
effadvfash_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
effadvfash_js[i] = (vadvfash_js[i]/(FOLLOWERS[i] * REAL_PEOPLE_PERC[i])) * 100;
}
dmr_data2[13] = vadv_js;
dmr_data2[14] = vadvfash_js;
dmr_data2[15] = effadvfash_js;
colnames(dmr_data2)[13] = "ADV_VIEWS_MEDIE";
colnames(dmr_data2)[14] = "FASHION_ADV_VIEWS_MEDIE";
colnames(dmr_data2)[15] = "FASHION_ADV_EFF_RATE";
attach(dmr_data2)
write.csv2(dmr_data2, file = "DMR_data.csv", quote = F, na = "", row.names = T, col.names = T);
getwd()
View(dmr_data2)
dmr_data1 = dmr_data;
attach(dmr_data1);
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (n_js);
emed_js = c(ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:B_s){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
vmed_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS_MEDIE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)));
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[10] <- "VIEWS_RATE";
vmedfash_js = seq(0,0,length.out = B_s);
efffash_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmedfash_js[i] = VIEWS_MEDIE[i] * FASHION_AUDIENCE_PERC[i];
}
for (i in 1:B_s){
efffash_js[i] = (vmedfash_js[i]/(FOLLOWERS[i]*REAL_PEOPLE_PERC[i]))*100;
}
dmr_data1[[11]] = vmedfash_js;
dmr_data1[[12]] = efffash_js;
colnames(dmr_data1)[11] = "FASHION_VIEWS_MEDIE";
colnames(dmr_data1)[12] = "FASHION_EFF_RATE";
attach(dmr_data1);
dmr_data2 = dmr_data1;
dmr_data2$ADV_ENG_RATE[which(is.na(dmr_data2$ADV_ENG_RATE) == T)] = 0;
emedadv_js = c(dmr_data2$ADV_ENG_RATE);
emaxadv_js = max (emedadv_js);
vadv_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vadv_js[i] = FOLLOWERS[i]*(emedadv_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emedadv_js[i]/emaxadv_js)*(1 - emedadv_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)
}
vadvfash_js = seq(0,0,length(B_s));
for (i in 1:B_s){
vadvfash_js[i] = vadv_js[i] * FASHION_AUDIENCE_PERC[i];
}
effadvfash_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
effadvfash_js[i] = (vadvfash_js[i]/(FOLLOWERS[i] * REAL_PEOPLE_PERC[i])) * 100;
}
dmr_data2[13] = vadv_js;
dmr_data2[14] = vadvfash_js;
dmr_data2[15] = effadvfash_js;
colnames(dmr_data2)[13] = "ADV_VIEWS_MEDIE";
colnames(dmr_data2)[14] = "FASHION_ADV_VIEWS_MEDIE";
colnames(dmr_data2)[15] = "FASHION_ADV_EFF_RATE";
attach(dmr_data2)
write.csv2(dmr_data2, file = "DMR_data.csv", quote = F, na = "", row.names = T, col.names = T);
dmr_data1 = dmr_data;
attach(dmr_data1);
n_s = sum (POSTS);
n_js = c(POSTS);
B_s = length (n_js);
emed_js = c(ENG_RATE);
emaxj_js = max(emed_js);
emedvec_s = seq(0,0,length.out = B_s);
for (i in 1:B_s){
emedvec_s[i] = (n_js[i]*emed_js[i])/n_s;
}
emed_s=sum(emedvec_s)
vmed_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmed_js[i] = FOLLOWERS[i]*(emed_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emed_js[i]/emaxj_js)*(1 - emed_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100);
}
dmr_data1[[9]] = vmed_js;
colnames(dmr_data1)[9] <- "VIEWS_MEDIE";
vrate_js=seq(0,0,length.out = B_s);
for (i in 1:B_s){
vrate_js[i] = (vmed_js[i]/(FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)));
}
dmr_data1[[10]] = vrate_js;
colnames(dmr_data1)[10] <- "VIEWS_RATE";
vmedfash_js = seq(0,0,length.out = B_s);
efffash_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vmedfash_js[i] = VIEWS_MEDIE[i] * FASHION_AUDIENCE_PERC[i];
}
for (i in 1:B_s){
efffash_js[i] = (vmedfash_js[i]/(FOLLOWERS[i]*REAL_PEOPLE_PERC[i]))*100;
}
dmr_data1[[11]] = vmedfash_js;
dmr_data1[[12]] = efffash_js;
colnames(dmr_data1)[11] = "FASHION_VIEWS_MEDIE";
colnames(dmr_data1)[12] = "FASHION_EFF_RATE";
attach(dmr_data1);
dmr_data2 = dmr_data1;
dmr_data2$ADV_ENG_RATE[which(is.na(dmr_data2$ADV_ENG_RATE) == T)] = 0;
emedadv_js = c(dmr_data2$ADV_ENG_RATE);
emaxadv_js = max (emedadv_js);
vadv_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
vadv_js[i] = FOLLOWERS[i]*(emedadv_js[i]/100)*(REAL_PEOPLE_PERC[i]/100) + (emedadv_js[i]/emaxadv_js)*(1 - emedadv_js[i]/100)*FOLLOWERS[i]*(REAL_PEOPLE_PERC[i]/100)
}
vadvfash_js = seq(0,0,length(B_s));
for (i in 1:B_s){
vadvfash_js[i] = vadv_js[i] * FASHION_AUDIENCE_PERC[i];
}
effadvfash_js = seq(0,0,length.out = B_s);
for (i in 1:B_s){
effadvfash_js[i] = (vadvfash_js[i]/(FOLLOWERS[i] * REAL_PEOPLE_PERC[i])) * 100;
}
dmr_data2[13] = vadv_js;
dmr_data2[14] = vadvfash_js;
dmr_data2[15] = effadvfash_js;
colnames(dmr_data2)[13] = "ADV_VIEWS_MEDIE";
colnames(dmr_data2)[14] = "FASHION_ADV_VIEWS_MEDIE";
colnames(dmr_data2)[15] = "FASHION_ADV_EFF_RATE";
attach(dmr_data2)
write.csv2(dmr_data2, file = "DMR_data.csv", quote = F, na = "", row.names = T, col.names = T);
View(dmr_data2)
getwd()
Sys.which("make")
install.packages("jsonlite", type = "source")
install.packages("cmdstanr", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))
cmdstanr::install_cmdstan()
library(cmdstanr)
check_cmdstan_toolchain(fix=TRUE)
cmdstanr::install_cmdstan()
load('Simulated_WP.RData')
setwd("C:/Users/pietr/Desktop/Bayesian Statistics/Progetto/dati/BayesianProject")
load('Simulated_WP.RData')
data<-data1
rm(data1)
c_lab_tot <- matrix(0,n,n)
y0 <- 1
for (i in 1:n){
y00 <- 2
c_lab <- rep(0,n)
if (Mahalanobis_Distance[i,y0] > Mahalanobis_Distance[i,y00]){
c_lab[i] <- 1
}
if (Mahalanobis_Distance[i,y0] < Mahalanobis_Distance[i,y00]){
c_lab[i] <- 2
}
c_lab_tot[i,] <- c_lab
y00 <- y00 + 1
if (y00 > 26){
y00 <- 1
}
}
View(c_lab_tot)
y0 <- 1
y00 <- 2
c_lab <- rep(0,n)
if (Mahalanobis_Distance[i,y0] > Mahalanobis_Distance[i,y00]){
c_lab[i] <- 1
}
y0 <- 1
y00 <- 2
c_lab_tot <- matrix(0,n,n^2)
View(c_lab_tot)
y0 <- 1
y00 <- 1
c_lab_tot <- matrix(0,n,n^2)
c_lab_tot <- matrix(0,n,(n-1)^2)
y0 <- sample(1:n)
y0
y0 <- sample(1:n,1)
y0 <- sample(1:n,1)
y0
y0 <- sample(1:n,1)
y00 <- sample(1:n,1)
while (y00 == y0) {
y00 <- sample(1:n,1)
}
y0.1 <- sample(1:n,1)
y0.2 <- sample(1:n,1)
setwd("C:/Users/pietr/Desktop/Bayesian Statistics/Progetto/dati/BayesianProject")
load('Simulated_WP.RData')
data<-data1
rm(data1)
y0.1 <- sample(1:n,1)
y0.2 <- sample(1:n,1)
set.seed(123456789)
y0.1 <- sample(1:n,1)
y0.2 <- sample(1:n,1)
while (y0.2 == y0.1) {
y0.2 <- sample(1:n,1)
}
c_lab <- rep(0,n)
for (i in 1:n){
if (Mahalanobis_Distance[y0.1,i] < Mahalanobis_Distance[y0.2,i]){
c_lab[i] <- 1
}
if (Mahalanobis_Distance[y0.1,i] > Mahalanobis_Distance[y0.2,i])
c_lab[i] <- 2
}
c_lab
y0.1 <- sample(1:n,1)
y0.2 <- sample(1:n,1)
while (y0.2 == y0.1) {
y0.2 <- sample(1:n,1)
}
c_lab <- rep(0,n)
for (i in 1:n){
if (Mahalanobis_Distance[y0.1,i] < Mahalanobis_Distance[y0.2,i]){
c_lab[i] <- 1
}
if (Mahalanobis_Distance[y0.1,i] > Mahalanobis_Distance[y0.2,i])
c_lab[i] <- 2
}
c_lab
list(y0.1,y0.2)
dim(list(y0.1,y0.2))
centr <- list(y0.1,y0.2)
centr[1]
centr[[1]]
View(alpha_Mahalanobis)
View(data)
#### Clustering function ####
y0.1 <- sample(1:n,1)
y0.2 <- sample(1:n,1)
centroids <- list(data[y0.1,], data[y0.2,])
gibbs_loss <- function(n_clust, centroids, label ,data){
res = rep(0,n_clust)
for (k in 1:n_clust){
for (i in 1:n){
if (label[i] == k){
sum_partial = alpha_Mahalanobis(alpha,data[i,],centroids[[k]],eig$values,eig$vectors)
res[k] = res[k] + sum_partial
}
}
}
tot = sum(res)
return(tot)
}
View(cov_M1)
View(gibbs_loss)
centroidi <- list(data[y0.1,], data[y0.2,])
rm(centroids)
gibbs_loss(n_clust = 2, centroids = centroidi, label = c_lab, data = data)
dim(data)
View(data)
data[which(c_lab==1')]
]
clc
